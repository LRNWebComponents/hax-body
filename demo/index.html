<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>hax-body demo</title>

    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>

    <link rel="import" href="../../iron-demo-helpers/demo-pages-shared-styles.html">
    <link rel="import" href="../../iron-demo-helpers/demo-snippet.html">
    <link rel="import" href="../hax-body.html">
    <link rel="import" href="../../hax-panel/hax-panel.html">
    <link rel="import" href="../../lrnsys-layout/lrnsys-dialog.html">
    <link rel="import" href="../../paper-toast/paper-toast.html">

    <style is="custom-style" include="demo-pages-shared-styles">
      .vertical-section-container {
        max-width: 60em;
        margin-left: 20em;
      }
    </style>
  </head>
  <body>
    <div class="vertical-section-container">
      <h3>Basic hax-body demo</h3>
      <demo-snippet>
        <template is="dom-bind">
          <hax-body id="body" edit-mode>
            <h2>Heading 2</h2>
            <p>A whole bunch of text in here that's awesome!</p>
            <h3>Heading 3</h3>
            <p>A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!A whole bunch of text in here that's awesome!</p>
            <p>Another paragraph that's a bit of a break from a whole bunch of text in here that's awesome!</p>
          </hax-body>

          <!-- potential wiring to make this work -->
          <hax-panel id="panel" opened></hax-panel>
          <paper-toast id="toast"></paper-toast>
          <lrnsys-dialog body-append id="dialog" title="See HTML">
            <h2 slot="header">HTML generated</h2>
            <div>
              <textarea id="textarea" rows="20" style="width:100%;"></textarea>
            </div>
          </lrnsys-dialog>
          <paper-button id="togglebutton">Enabled</paper-button>
          <script>
            var p = document.querySelector('#panel');
            var b = document.querySelector('#body');
            var button = document.querySelector('#togglebutton');
            // alert if there was an error loading content
            p.addEventListener('hax-content-insert', function(e) {
              document.querySelector('#toast').show(e.detail.eventName);
              b.haxInsert(e.detail.tag, e.detail.content);
            });
            // alert if there was an error loading content
            p.addEventListener('hax-item-selected', function(e) {
              document.querySelector('#toast').show(e.detail.eventName);
              if (e.detail.eventName === 'advanced-import-export') {
                let content = b.haxToContent();
                document.querySelector('#textarea').innerHTML = content;
                document.querySelector('#dialog').toggleDialog();
              }
            });
            // alert if there was an error loading content
            b.addEventListener('hax-body-tag-removed', function(e) {
              document.querySelector('#toast').show('deleted ' + e.detail.node.tagName);
            });
            // simple toggle for state to ensure it matches
            button.addEventListener('click', function(e) {
              window.open = !window.open;
              p.opened = window.open;
              b.editMode = window.open;
            });
          </script>
        </template>
      </demo-snippet>
    </div>
  </body>
</html>
